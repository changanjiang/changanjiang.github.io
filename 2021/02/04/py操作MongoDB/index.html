<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/changan/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/changan/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/changan/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/changan/images/logo.svg" color="#222">

<link rel="stylesheet" href="/changan/css/main.css">


<link rel="stylesheet" href="/changan/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"limiaomiaoa.gitee.io","root":"/changan/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="MongoDB是由C++语言编写的非关系型数据库，是一个基于分布式文件存储的开源数据库系统，其内容存储形式类似JSON对象，它的字段值可以包含其他文档、数组及文档数组，非常灵活。在这一节中，我们就来看看Python 3下MongoDB的存储操作。 1. 准备工作 在开始之前，请确保已经安装好了MongoDB并启动了其服务，并且安装好了Python的PyMongo库。 2. 连接MongoDB 连接">
<meta property="og:type" content="article">
<meta property="og:title" content="py操作MongoDB">
<meta property="og:url" content="https://limiaomiaoa.gitee.io/2021/02/04/py%E6%93%8D%E4%BD%9CMongoDB/index.html">
<meta property="og:site_name" content="威猛的小老虎">
<meta property="og:description" content="MongoDB是由C++语言编写的非关系型数据库，是一个基于分布式文件存储的开源数据库系统，其内容存储形式类似JSON对象，它的字段值可以包含其他文档、数组及文档数组，非常灵活。在这一节中，我们就来看看Python 3下MongoDB的存储操作。 1. 准备工作 在开始之前，请确保已经安装好了MongoDB并启动了其服务，并且安装好了Python的PyMongo库。 2. 连接MongoDB 连接">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-04T09:28:43.000Z">
<meta property="article:modified_time" content="2021-02-04T09:29:56.584Z">
<meta property="article:author" content="changan">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="py">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://limiaomiaoa.gitee.io/2021/02/04/py%E6%93%8D%E4%BD%9CMongoDB/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>py操作MongoDB | 威猛的小老虎</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/changan/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">威猛的小老虎</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/changan/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/changan/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://limiaomiaoa.gitee.io/2021/02/04/py%E6%93%8D%E4%BD%9CMongoDB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="http://59.50.1.5:14080/ftpuser/ygl/null/null20210201/b1872b49-de2a-4eab-be52-09d0eb263c51.png">
      <meta itemprop="name" content="changan">
      <meta itemprop="description" content="欢迎您的到来！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="威猛的小老虎">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          py操作MongoDB
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-04 17:28:43 / 修改时间：17:29:56" itemprop="dateCreated datePublished" datetime="2021-02-04T17:28:43+08:00">2021-02-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>MongoDB是由C++语言编写的非关系型数据库，是一个基于分布式文件存储的开源数据库系统，其内容存储形式类似JSON对象，它的字段值可以包含其他文档、数组及文档数组，非常灵活。在这一节中，我们就来看看Python 3下MongoDB的存储操作。</p>
<p><strong>1. 准备工作</strong></p>
<p>在开始之前，请确保已经安装好了MongoDB并启动了其服务，并且安装好了Python的PyMongo库。</p>
<p><strong>2. 连接MongoDB</strong></p>
<p>连接MongoDB时，我们需要使用PyMongo库里面的MongoClient。一般来说，传入MongoDB的IP及端口即可，其中第一个参数为地址host，第二个参数为端口port（如果不给它传递参数，默认是27017）：</p>
<p>import pymongo client = pymongo.MongoClient(host=’localhost’, port=27017)复制代码</p>
<p>这样就可以创建MongoDB的连接对象了。</p>
<p>另外，MongoClient的第一个参数host还可以直接传入MongoDB的连接字符串，它以mongodb开头，例如：</p>
<p>client = MongoClient(‘mongodb://localhost:27017/‘)复制代码</p>
<p>这也可以达到同样的连接效果。</p>
<p><strong>3. 指定数据库</strong></p>
<p>MongoDB中可以建立多个数据库，接下来我们需要指定操作哪个数据库。这里我们以test数据库为例来说明，下一步需要在程序中指定要使用的数据库：</p>
<p>db = client.test复制代码</p>
<p>这里调用client的test属性即可返回test数据库。当然，我们也可以这样指定：</p>
<p>db = client[‘test’]复制代码</p>
<p>这两种方式是等价的。</p>
<p><strong>4. 指定集合</strong></p>
<p>MongoDB的每个数据库又包含许多集合（collection），它们类似于关系型数据库中的表。</p>
<p>下一步需要指定要操作的集合，这里指定一个集合名称为students。与指定数据库类似，指定集合也有两种方式：</p>
<p>collection = db.students复制代码</p>
<p>collection = db[‘students’]复制代码</p>
<p>这样我们便声明了一个Collection对象。</p>
<p><strong>5. 插入数据</strong></p>
<p>接下来，便可以插入数据了。对于students这个集合，新建一条学生数据，这条数据以字典形式表示：</p>
<p>student = {    ‘id’: ‘20170101’,    ‘name’: ‘Jordan’,    ‘age’: 20,    ‘gender’: ‘male’ }复制代码</p>
<p>这里指定了学生的学号、姓名、年龄和性别。接下来，直接调用collection的insert()方法即可插入数据，代码如下：</p>
<p>result = collection.insert(student) print(result)复制代码</p>
<p>在MongoDB中，每条数据其实都有一个_id属性来唯一标识。如果没有显式指明该属性，MongoDB会自动产生一个ObjectId类型的_id属性。insert()方法会在执行后返回_id值。</p>
<p>运行结果如下：</p>
<p>5932a68615c2606814c91f3d复制代码</p>
<p>当然，我们也可以同时插入多条数据，只需要以列表形式传递即可，示例如下：</p>
<p>student1 = {    ‘id’: ‘20170101’,    ‘name’: ‘Jordan’,    ‘age’: 20,    ‘gender’: ‘male’ } student2 = {    ‘id’: ‘20170202’,    ‘name’: ‘Mike’,    ‘age’: 21,    ‘gender’: ‘male’ } result = collection.insert([student1, student2]) print(result)复制代码</p>
<p>返回结果是对应的_id的集合：</p>
<p>[ObjectId(‘5932a80115c2606a59e8a048’), ObjectId(‘5932a80115c2606a59e8a049’)]复制代码</p>
<p>实际上，在PyMongo 3.x版本中，官方已经不推荐使用insert()方法了。当然，继续使用也没有什么问题。官方推荐使用insert_one()和insert_many()方法来分别插入单条记录和多条记录，示例如下：</p>
<p>student = {    ‘id’: ‘20170101’,    ‘name’: ‘Jordan’,    ‘age’: 20,    ‘gender’: ‘male’ } result = collection.insert_one(student) print(result) print(result.inserted_id)复制代码</p>
<p>运行结果如下：</p>
<p>&lt;pymongo.results.InsertOneResult object at 0x10d68b558&gt; 5932ab0f15c2606f0c1cf6c5复制代码</p>
<p>与insert()方法不同，这次返回的是InsertOneResult对象，我们可以调用其inserted_id属性获取_id。</p>
<p>对于insert_many()方法，我们可以将数据以列表形式传递，示例如下：</p>
<p>student1 = {    ‘id’: ‘20170101’,    ‘name’: ‘Jordan’,    ‘age’: 20,    ‘gender’: ‘male’ } student2 = {    ‘id’: ‘20170202’,    ‘name’: ‘Mike’,    ‘age’: 21,    ‘gender’: ‘male’ } result = collection.insert_many([student1, student2]) print(result) print(result.inserted_ids)复制代码</p>
<p>运行结果如下：</p>
<p>&lt;pymongo.results.InsertManyResult object at 0x101dea558&gt; [ObjectId(‘5932abf415c2607083d3b2ac’), ObjectId(‘5932abf415c2607083d3b2ad’)]复制代码</p>
<p>该方法返回的类型是InsertManyResult，调用inserted_ids属性可以获取插入数据的_id列表。</p>
<p><strong>6. 查询</strong></p>
<p>插入数据后，我们可以利用find_one()或find()方法进行查询，其中find_one()查询得到的是单个结果，find()则返回一个生成器对象。示例如下：</p>
<p>result = collection.find_one({‘name’: ‘Mike’}) print(type(result)) print(result)复制代码</p>
<p>这里我们查询name为Mike的数据，它的返回结果是字典类型，运行结果如下：</p>
<p>&lt;class ‘dict’&gt; {‘_id’: ObjectId(‘5932a80115c2606a59e8a049’), ‘id’: ‘20170202’, ‘name’: ‘Mike’, ‘age’: 21, ‘gender’: ‘male’}复制代码</p>
<p>可以发现，它多了_id属性，这就是MongoDB在插入过程中自动添加的。</p>
<p>此外，我们也可以根据ObjectId来查询，此时需要使用bson库里面的objectid：</p>
<p>from bson.objectid import ObjectId result = collection.find_one({‘_id’: ObjectId(‘593278c115c2602667ec6bae’)}) print(result)复制代码</p>
<p>其查询结果依然是字典类型，具体如下：</p>
<p>{‘_id’: ObjectId(‘593278c115c2602667ec6bae’), ‘id’: ‘20170101’, ‘name’: ‘Jordan’, ‘age’: 20, ‘gender’: ‘male’}复制代码</p>
<p>当然，如果查询结果不存在，则会返回None。</p>
<p>对于多条数据的查询，我们可以使用find()方法。例如，这里查找年龄为20的数据，示例如下：</p>
<p>results = collection.find({‘age’: 20}) print(results) <strong>for</strong> result <strong>in</strong> results:    print(result)复制代码</p>
<p>运行结果如下：</p>
<p>&lt;pymongo.cursor.Cursor object at 0x1032d5128&gt; {‘_id’: ObjectId(‘593278c115c2602667ec6bae’), ‘id’: ‘20170101’, ‘name’: ‘Jordan’, ‘age’: 20, ‘gender’: ‘male’} {‘_id’: ObjectId(‘593278c815c2602678bb2b8d’), ‘id’: ‘20170102’, ‘name’: ‘Kevin’, ‘age’: 20, ‘gender’: ‘male’} {‘_id’: ObjectId(‘593278d815c260269d7645a8’), ‘id’: ‘20170103’, ‘name’: ‘Harden’, ‘age’: 20, ‘gender’: ‘male’}复制代码</p>
<p>返回结果是Cursor类型，它相当于一个生成器，我们需要遍历取到所有的结果，其中每个结果都是字典类型。</p>
<p>如果要查询年龄大于20的数据，则写法如下：</p>
<p>results = collection.find({‘age’: {‘$gt’: 20}})复制代码</p>
<p>这里查询的条件键值已经不是单纯的数字了，而是一个字典，其键名为比较符号$gt，意思是大于，键值为20。</p>
<p>这里将比较符号归纳为下表。</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>$lt</td>
<td>小于</td>
<td>{‘age’: {‘$lt’: 20}}</td>
</tr>
<tr>
<td>$gt</td>
<td>大于</td>
<td>{‘age’: {‘$gt’: 20}}</td>
</tr>
<tr>
<td>$lte</td>
<td>小于等于</td>
<td>{‘age’: {‘$lte’: 20}}</td>
</tr>
<tr>
<td>$gte</td>
<td>大于等于</td>
<td>{‘age’: {‘$gte’: 20}}</td>
</tr>
<tr>
<td>$ne</td>
<td>不等于</td>
<td>{‘age’: {‘$ne’: 20}}</td>
</tr>
<tr>
<td>$in</td>
<td>在范围内</td>
<td>{‘age’: {‘$in’: [20, 23]}}</td>
</tr>
<tr>
<td>$nin</td>
<td>不在范围内</td>
<td>{‘age’: {‘$nin’: [20, 23]}}</td>
</tr>
</tbody></table>
<p>另外，还可以进行正则匹配查询。例如，查询名字以M开头的学生数据，示例如下：</p>
<p>results = collection.find({‘name’: {‘$regex’: ‘^M.*’}})复制代码</p>
<p>这里使用$regex来指定正则匹配，^M.*代表以M开头的正则表达式。</p>
<p>这里将一些功能符号再归类为下表。</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>示例</th>
<th>示例含义</th>
</tr>
</thead>
<tbody><tr>
<td>$regex</td>
<td>匹配正则表达式</td>
<td>{‘name’: {‘$regex’: ‘^M.*’}}</td>
<td>name以M开头</td>
</tr>
<tr>
<td>$exists</td>
<td>属性是否存在</td>
<td>{‘name’: {‘$exists’: True}}</td>
<td>name属性存在</td>
</tr>
<tr>
<td>$type</td>
<td>类型判断</td>
<td>{‘age’: {‘$type’: ‘int’}}</td>
<td>age的类型为int</td>
</tr>
<tr>
<td>$mod</td>
<td>数字模操作</td>
<td>{‘age’: {‘$mod’: [5, 0]}}</td>
<td>年龄模5余0</td>
</tr>
<tr>
<td>$text</td>
<td>文本查询</td>
<td>{‘$text’: {‘$search’: ‘Mike’}}</td>
<td>text类型的属性中包含Mike字符串</td>
</tr>
<tr>
<td>$where</td>
<td>高级条件查询</td>
<td>{‘$where’: ‘obj.fans_count == obj.follows_count’}</td>
<td>自身粉丝数等于关注数</td>
</tr>
</tbody></table>
<p>关于这些操作的更详细用法，可以在MongoDB官方文档找到：</p>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/operator/query/%E3%80%82">https://docs.mongodb.com/manual/reference/operator/query/。</a></p>
<p><strong>7. 计数</strong></p>
<p>要统计查询结果有多少条数据，可以调用count()方法。比如，统计所有数据条数：</p>
<p>count = collection.find().count() print(count)复制代码</p>
<p>或者统计符合某个条件的数据：</p>
<p>count = collection.find({‘age’: 20}).count() print(count)复制代码</p>
<p>运行结果是一个数值，即符合条件的数据条数。</p>
<p><strong>8. 排序</strong></p>
<p>排序时，直接调用sort()方法，并在其中传入排序的字段及升降序标志即可。示例如下：</p>
<p>results = collection.find().sort(‘name’, pymongo.ASCENDING) print([result[‘name’] <strong>for</strong> result <strong>in</strong> results])复制代码</p>
<p>运行结果如下：</p>
<p>[‘Harden’, ‘Jordan’, ‘Kevin’, ‘Mark’, ‘Mike’]复制代码</p>
<p>这里我们调用pymongo.ASCENDING指定升序。如果要降序排列，可以传入pymongo.DESCENDING。</p>
<p><strong>9. 偏移</strong></p>
<p>在某些情况下，我们可能想只取某几个元素，这时可以利用skip()方法偏移几个位置，比如偏移2，就忽略前两个元素，得到第三个及以后的元素：</p>
<p>results = collection.find().sort(‘name’, pymongo.ASCENDING).skip(2) print([result[‘name’] <strong>for</strong> result <strong>in</strong> results])复制代码</p>
<p>运行结果如下：</p>
<p>[‘Kevin’, ‘Mark’, ‘Mike’]复制代码</p>
<p>另外，还可以用limit()方法指定要取的结果个数，示例如下：</p>
<p>results = collection.find().sort(‘name’, pymongo.ASCENDING).skip(2).limit(2) print([result[‘name’] <strong>for</strong> result <strong>in</strong> results])复制代码</p>
<p>运行结果如下：</p>
<p>[‘Kevin’, ‘Mark’]复制代码</p>
<p>如果不使用limit()方法，原本会返回三个结果，加了限制后，会截取两个结果返回。</p>
<p>值得注意的是，在数据库数量非常庞大的时候，如千万、亿级别，最好不要使用大的偏移量来查询数据，因为这样很可能导致内存溢出。此时可以使用类似如下操作来查询：</p>
<p>from bson.objectid import ObjectId collection.find({‘_id’: {‘$gt’: ObjectId(‘593278c815c2602678bb2b8d’)}})复制代码</p>
<p>这时需要记录好上次查询的_id。</p>
<p><strong>10. 更新</strong></p>
<p>对于数据更新，我们可以使用update()方法，指定更新的条件和更新后的数据即可。例如：</p>
<p>condition = {‘name’: ‘Kevin’} student = collection.find_one(condition) student[‘age’] = 25 result = collection.update(condition, student) print(result)复制代码</p>
<p>这里我们要更新name为Kevin的数据的年龄：首先指定查询条件，然后将数据查询出来，修改年龄后调用update()方法将原条件和修改后的数据传入。</p>
<p>运行结果如下：</p>
<p>{‘ok’: 1, ‘nModified’: 1, ‘n’: 1, ‘updatedExisting’: True}复制代码</p>
<p>返回结果是字典形式，ok代表执行成功，nModified代表影响的数据条数。</p>
<p>另外，我们也可以使用$set操作符对数据进行更新，代码如下：</p>
<p>result = collection.update(condition, {‘$set’: student})复制代码</p>
<p>这样可以只更新student字典内存在的字段。如果原先还有其他字段，则不会更新，也不会删除。而如果不用$set的话，则会把之前的数据全部用student字典替换；如果原本存在其他字段，则会被删除。</p>
<p>另外，update()方法其实也是官方不推荐使用的方法。这里也分为update_one()方法和update_many()方法，用法更加严格，它们的第二个参数需要使用$类型操作符作为字典的键名，示例如下：</p>
<p>condition = {‘name’: ‘Kevin’} student = collection.find_one(condition) student[‘age’] = 26 result = collection.update_one(condition, {‘$set’: student}) print(result) print(result.matched_count, result.modified_count)复制代码</p>
<p>这里调用了update_one()方法，第二个参数不能再直接传入修改后的字典，而是需要使用{‘$set’: student}这样的形式，其返回结果是UpdateResult类型。然后分别调用matched_count和modified_count属性，可以获得匹配的数据条数和影响的数据条数。</p>
<p>运行结果如下：</p>
<p>&lt;pymongo.results.UpdateResult object at 0x10d17b678&gt; 1 0复制代码</p>
<p>我们再看一个例子：</p>
<p>condition = {‘age’: {‘$gt’: 20}} result = collection.update_one(condition, {‘$inc’: {‘age’: 1}}) print(result) print(result.matched_count, result.modified_count)复制代码</p>
<p>这里指定查询条件为年龄大于20，然后更新条件为{‘$inc’: {‘age’: 1}}，也就是年龄加1，执行之后会将第一条符合条件的数据年龄加1。</p>
<p>运行结果如下：</p>
<p>&lt;pymongo.results.UpdateResult object at 0x10b8874c8&gt; 1 1复制代码</p>
<p>可以看到匹配条数为1条，影响条数也为1条。</p>
<p>如果调用update_many()方法，则会将所有符合条件的数据都更新，示例如下：</p>
<p>condition = {‘age’: {‘$gt’: 20}} result = collection.update_many(condition, {‘$inc’: {‘age’: 1}}) print(result) print(result.matched_count, result.modified_count)复制代码</p>
<p>这时匹配条数就不再为1条了，运行结果如下：</p>
<p>&lt;pymongo.results.UpdateResult object at 0x10c6384c8&gt; 3 3复制代码</p>
<p>可以看到，这时所有匹配到的数据都会被更新。</p>
<p><strong>11. 删除</strong></p>
<p>删除操作比较简单，直接调用remove()方法指定删除的条件即可，此时符合条件的所有数据均会被删除。示例如下：</p>
<p>result = collection.remove({‘name’: ‘Kevin’}) print(result)复制代码</p>
<p>运行结果如下：</p>
<p>{‘ok’: 1, ‘n’: 1}复制代码</p>
<p>另外，这里依然存在两个新的推荐方法——delete_one()和delete_many()。示例如下：</p>
<p>result = collection.delete_one({‘name’: ‘Kevin’}) print(result) print(result.deleted_count) result = collection.delete_many({‘age’: {‘$lt’: 25}}) print(result.deleted_count)复制代码</p>
<p>运行结果如下：</p>
<p>&lt;pymongo.results.DeleteResult object at 0x10e6ba4c8&gt; 1 4复制代码</p>
<p>delete_one()即删除第一条符合条件的数据，delete_many()即删除所有符合条件的数据。它们的返回结果都是DeleteResult类型，可以调用deleted_count属性获取删除的数据条数。</p>
<p><strong>12. 其他操作</strong></p>
<p>另外，PyMongo还提供了一些组合方法，如find_one_and_delete()、find_one_and_replace()和find_one_and_update()，它们是查找后删除、替换和更新操作，其用法与上述方法基本一致。</p>
<p>另外，还可以对索引进行操作，相关方法有create_index()、create_indexes()和drop_index()等。</p>
<p>关于PyMongo的详细用法，可以参见官方文档：<a target="_blank" rel="noopener" href="http://api.mongodb.com/python/current/api/pymongo/collection.html%E3%80%82">http://api.mongodb.com/python/current/api/pymongo/collection.html。</a></p>
<p>另外，还有对数据库和集合本身等的一些操作，这里不再一一讲解，可以参见官方文档：<a target="_blank" rel="noopener" href="http://api.mongodb.com/python/current/api/pymongo/%E3%80%82">http://api.mongodb.com/python/current/api/pymongo/。</a></p>
<p>本节讲解了使用PyMongo操作MongoDB进行数据增删改查的方法。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/changan/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 数据库</a>
              <a href="/changan/tags/py/" rel="tag"># py</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/changan/2021/02/04/Mongo%E4%B8%8EMysql%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BA%8B/" rel="prev" title="Mongo与Mysql的一些事">
      <i class="fa fa-chevron-left"></i> Mongo与Mysql的一些事
    </a></div>
      <div class="post-nav-item">
    <a href="/changan/2021/02/04/portainer%E6%90%AD%E5%BB%BA/" rel="next" title="portainer搭建">
      portainer搭建 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="changan"
      src="http://59.50.1.5:14080/ftpuser/ygl/null/null20210201/b1872b49-de2a-4eab-be52-09d0eb263c51.png">
  <p class="site-author-name" itemprop="name">changan</p>
  <div class="site-description" itemprop="description">欢迎您的到来！</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/changan/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">changan</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/changan/lib/anime.min.js"></script>
  <script src="/changan/lib/velocity/velocity.min.js"></script>
  <script src="/changan/lib/velocity/velocity.ui.min.js"></script>

<script src="/changan/js/utils.js"></script>

<script src="/changan/js/motion.js"></script>


<script src="/changan/js/schemes/pisces.js"></script>


<script src="/changan/js/next-boot.js"></script>




  















  

  

</body>
</html>
